# Write your MySQL query statement below


# Write an SQL query to find all the pairs of users with the maximum number of common followers. In other words, if the maximum number of common followers between any two users is maxCommon, then you have to return all pairs of users that have maxCommon common followers.

# Input: 
# Relations table:
# +---------+-------------+
# | user_id | follower_id |
# +---------+-------------+
# | 1       | 3           |
# | 2       | 3           |
# | 7       | 3           |
# | 1       | 4           |

#寻找最多common follower，先inner join 根据follower_id, 形成两两关系，再group by两个id

with t as
    (select r1.user_id as user1_id, r2.user_id as user2_id, count(1) as cnt
          from relations as r1
            inner join relations as r2
            on r1.follower_id = r2.follower_id
            and r1.user_id < r2.user_id
          group by r1.user_id, r2.user_id)
select user1_id,user2_id
from t
where cnt =(select max(cnt) from t)
