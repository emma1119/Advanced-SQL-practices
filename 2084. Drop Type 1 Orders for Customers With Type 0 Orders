2084. Drop Type 1 Orders for Customers With Type 0 Orders


# If a customer has at least one order of type 0, do not report any order of type 1 from that customer.
# otherwise report all

# 有0选0，不选1，没有0选1

select 
order_id,
customer_id,
order_type
from orders 
where order_type = 0
union all
(
select 
order_id,
customer_id,
order_type
from orders 
where order_type = 1
and customer_id not in 
(select distinct customer_id from orders where order_type = 0) 
)

# or window function by customer_id order by order_type
select order_id, customer_id, order_type from 
(select *, 
dense_rank() over (partition by customer_id order by order_type) rk 
from Orders) a 
where rk=1
